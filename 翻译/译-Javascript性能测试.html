<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>译：Javascript 性能测试- for 对比 for each 对比 (map, reduce, filter, find). | zanzan学习日记</title>
    <meta name="description" content="zanzan学习日记">
    <link rel="icon" href="/mydairy/logo.png">
  <link rel="manifest" href="/mydairy/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/mydairy/assets/css/0.styles.1cf60974.css" as="style"><link rel="preload" href="/mydairy/assets/js/app.75fc6940.js" as="script"><link rel="preload" href="/mydairy/assets/js/37.942ffb8a.js" as="script"><link rel="prefetch" href="/mydairy/assets/js/10.24ee9478.js"><link rel="prefetch" href="/mydairy/assets/js/11.1f619359.js"><link rel="prefetch" href="/mydairy/assets/js/12.3c36bd4f.js"><link rel="prefetch" href="/mydairy/assets/js/13.14b33cee.js"><link rel="prefetch" href="/mydairy/assets/js/14.62bd276d.js"><link rel="prefetch" href="/mydairy/assets/js/15.c9556f2c.js"><link rel="prefetch" href="/mydairy/assets/js/16.2f14dcd3.js"><link rel="prefetch" href="/mydairy/assets/js/17.fbb78354.js"><link rel="prefetch" href="/mydairy/assets/js/18.176247b6.js"><link rel="prefetch" href="/mydairy/assets/js/19.80e3485a.js"><link rel="prefetch" href="/mydairy/assets/js/2.f6874750.js"><link rel="prefetch" href="/mydairy/assets/js/20.b908b72f.js"><link rel="prefetch" href="/mydairy/assets/js/21.3a595c73.js"><link rel="prefetch" href="/mydairy/assets/js/22.94606d85.js"><link rel="prefetch" href="/mydairy/assets/js/23.5b765237.js"><link rel="prefetch" href="/mydairy/assets/js/24.3de0898e.js"><link rel="prefetch" href="/mydairy/assets/js/25.6b91c792.js"><link rel="prefetch" href="/mydairy/assets/js/26.3ca0563a.js"><link rel="prefetch" href="/mydairy/assets/js/27.42ce8718.js"><link rel="prefetch" href="/mydairy/assets/js/28.3c1efd17.js"><link rel="prefetch" href="/mydairy/assets/js/29.7e2303b5.js"><link rel="prefetch" href="/mydairy/assets/js/3.ffe8549c.js"><link rel="prefetch" href="/mydairy/assets/js/30.7dbb671e.js"><link rel="prefetch" href="/mydairy/assets/js/31.35ecee6e.js"><link rel="prefetch" href="/mydairy/assets/js/32.ea2ce080.js"><link rel="prefetch" href="/mydairy/assets/js/33.2c92d913.js"><link rel="prefetch" href="/mydairy/assets/js/34.a62cfaba.js"><link rel="prefetch" href="/mydairy/assets/js/35.bc3513d7.js"><link rel="prefetch" href="/mydairy/assets/js/36.8b60e39c.js"><link rel="prefetch" href="/mydairy/assets/js/38.bca56a1e.js"><link rel="prefetch" href="/mydairy/assets/js/39.d79fb24d.js"><link rel="prefetch" href="/mydairy/assets/js/4.9b0846a4.js"><link rel="prefetch" href="/mydairy/assets/js/40.00707b20.js"><link rel="prefetch" href="/mydairy/assets/js/5.fa7dc1d3.js"><link rel="prefetch" href="/mydairy/assets/js/6.1e3b789f.js"><link rel="prefetch" href="/mydairy/assets/js/7.b078faa6.js"><link rel="prefetch" href="/mydairy/assets/js/8.9448d2f8.js"><link rel="prefetch" href="/mydairy/assets/js/9.17d944a4.js">
    <link rel="stylesheet" href="/mydairy/assets/css/0.styles.1cf60974.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mydairy/" class="home-link router-link-active"><!----> <span class="site-name">zanzan学习日记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/zxy7/mydairy" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/zxy7/mydairy" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>翻译</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/mydairy/翻译/译-如何扩展SQLErrorCodesFactory.html" class="sidebar-link">译-如何扩展SQLErrorCodesFactory</a></li><li><a href="/mydairy/翻译/译-Javascript性能测试.html" class="active sidebar-link">译：Javascript 性能测试- for 对比 for each 对比 (map, reduce, filter, find).</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mydairy/翻译/译-Javascript性能测试.html#_1-reduce-对比-for-loop-对比-foreach" class="sidebar-link">1. Reduce 对比 for loop 对比 foreach</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>记录</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>微信小程序</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>python</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>java</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="译：javascript-性能测试-for-对比-for-each-对比-map-reduce-filter-find"><a href="#译：javascript-性能测试-for-对比-for-each-对比-map-reduce-filter-find" aria-hidden="true" class="header-anchor">#</a> 译：Javascript 性能测试- for 对比 for each 对比 (map, reduce, filter, find).</h1> <p>原文链接：<a href="https://hackernoon.com/javascript-performance-test-for-vs-for-each-vs-map-reduce-filter-find-32c1113f19d7" target="_blank" rel="noopener noreferrer">https://hackernoon.com/javascript-performance-test-for-vs-for-each-vs-map-reduce-filter-find-32c1113f19d7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/mydairy/img/001.jpeg" alt="Photo by Alex Holyoake on Unsplash"></p> <p>我们都知道 for 循环比for each或者 javascript 函数都要快，因为在 javascript 函数的框架下可能会使用 for 循环或者其他我不确定的东西。 我用一个对象数组做了一个简单的测试，并通过 for 循环 / foreach / javascript 函数执行了一些操作，并观察了执行所需的时间。</p> <blockquote><p>这些结果来自一些小示例，并且可能根据所执行的操作、选择的执行环境和选择的VM（virtual machine虚拟机）而有所不同。</p></blockquote> <h2 id="_1-reduce-对比-for-loop-对比-foreach"><a href="#_1-reduce-对比-for-loop-对比-foreach" aria-hidden="true" class="header-anchor">#</a> 1. Reduce 对比 for loop 对比 foreach</h2> <div class="language- extra-class"><pre class="language-text"><code>// 计算upVotes的和
const posts = [ 
  {id: 1, upVotes: 2},
  {id: 2, upVotes: 18}, 
  {id: 3, upVotes: 1}, 
  {id: 4, upVotes: 30}, 
  {id: 5, upVotes: 50} 
];
let sum = 0;
console.time('reduce');
sum = posts.reduce((s, p)=&gt; s+=p.upVotes,0);
console.timeEnd('reduce')
sum = 0;
console.time('for loop');
for(let i=0; i&lt;posts.length; i++) {
    sum += posts[i].upVotes;
}
console.timeEnd('for loop');
sum = 0;
console.time('for each');
posts.forEach(element =&gt; {
    sum += element.upVotes;
});
console.timeEnd('for each');
</code></pre></div><p>注意：以下是结果列表,代码可以在<a href="https://github.com/dg92/Performance-Analysis-JS" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>找到</p> <div class="language- extra-class"><pre class="language-text"><code>//本机chrome结果
reduce: 0.05322265625ms
for loop: 0.0390625ms
for each: 0.048095703125ms
</code></pre></div><p>所有的结果都清楚地表明 for 循环比 map / reduce / filter / find 更加熟练</p> <p>Map / reduce / filter / Find 由于许多原因而变慢，其中一些原因是</p> <ol><li>它们有一个回调要执行，因而作为一个开销</li> <li>js函数会考虑很多角落情况，比如 getter、稀疏数组和检查传递的参数是否是数组，这些都会增加开销</li></ol> <blockquote><p>我找到了一个依赖<a href="https://github.com/codemix/fast.js/tree/master" target="_blank" rel="noopener noreferrer">lib<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，重新实现了几个常见的内置原生 JavaScript 函数</p></blockquote> <p>但是，使用的选择不仅仅取决于性能，还有更多的因素需要考虑，其中一些是:</p> <ol><li>代码的可读性和可维护性</li> <li>简化代码</li> <li>快速编码</li> <li>实现与优化</li> <li>个人选择</li></ol> <p>就我个人而言，我喜欢 map, reduce, filter, find ，我使用他们很长时间了。 他们帮助我写的干净、精确、快速，并且符合我的思维过程。 当我别无选择时，我会使用 for 循环。 就优化而言，用 map / reduce / filter / find 来代替应该是最后一个选项，或者根据需要的优化级别而不能当作一个选项。</p> <blockquote><p>注意: 如果您使用 for 循环，总是以惯用方式使用它们，因为编译器现在足够智能，可以正确地优化惯用的循环</p></blockquote> <p>更新: 在<a href="https://github.com/dg92/Performance-Analysis-JS" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>你可以找到大数据集和海量计算的结果。</p> <p>数组大小为5-1000的小数据集的结果
<img src="/mydairy/img/small_data_set_result.png" alt="数组大小为5-1000的小数据集的结果"></p> <p>数组大小为3000-20000的中间数据集的结果
<img src="/mydairy/img/mid_data_set_result.png" alt="数组大小为3000-20000的中间数据集的结果"></p> <p>数组大小为50000-1000000的大数据集的结果
<img src="/mydairy/img/large_data_set_result.png" alt="数组大小为50000-1000000的大数据集的结果"></p> <p>注意：</p> <ol><li>这些结果是使用 Node V8 v5.8.283.41计算出来的</li> <li>这些结果没有考虑 JIT、内联缓存、隐藏类、失效、垃圾收集、伪装等等</li> <li>结果可能因环境不同而有所不同</li> <li>上面图片中的红色高光仅供参考，很快就会改变</li></ol> <p>如果你喜欢这篇文章，请推荐和分享，帮助别人找到它</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/zxy7/mydairy/edit/master/docs/翻译/译-Javascript性能测试.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">1/30/2019, 11:54:36 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/mydairy/assets/js/app.75fc6940.js" defer></script><script src="/mydairy/assets/js/37.942ffb8a.js" defer></script>
  </body>
</html>
