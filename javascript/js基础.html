<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js基础 | zanzan学习日记</title>
    <meta name="description" content="zanzan学习日记">
    <link rel="icon" href="/mydairy/logo.png">
  <link rel="manifest" href="/mydairy/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/mydairy/assets/css/0.styles.1cf60974.css" as="style"><link rel="preload" href="/mydairy/assets/js/app.75fc6940.js" as="script"><link rel="preload" href="/mydairy/assets/js/13.14b33cee.js" as="script"><link rel="prefetch" href="/mydairy/assets/js/10.24ee9478.js"><link rel="prefetch" href="/mydairy/assets/js/11.1f619359.js"><link rel="prefetch" href="/mydairy/assets/js/12.3c36bd4f.js"><link rel="prefetch" href="/mydairy/assets/js/14.62bd276d.js"><link rel="prefetch" href="/mydairy/assets/js/15.c9556f2c.js"><link rel="prefetch" href="/mydairy/assets/js/16.2f14dcd3.js"><link rel="prefetch" href="/mydairy/assets/js/17.fbb78354.js"><link rel="prefetch" href="/mydairy/assets/js/18.176247b6.js"><link rel="prefetch" href="/mydairy/assets/js/19.80e3485a.js"><link rel="prefetch" href="/mydairy/assets/js/2.f6874750.js"><link rel="prefetch" href="/mydairy/assets/js/20.b908b72f.js"><link rel="prefetch" href="/mydairy/assets/js/21.3a595c73.js"><link rel="prefetch" href="/mydairy/assets/js/22.94606d85.js"><link rel="prefetch" href="/mydairy/assets/js/23.5b765237.js"><link rel="prefetch" href="/mydairy/assets/js/24.3de0898e.js"><link rel="prefetch" href="/mydairy/assets/js/25.6b91c792.js"><link rel="prefetch" href="/mydairy/assets/js/26.3ca0563a.js"><link rel="prefetch" href="/mydairy/assets/js/27.42ce8718.js"><link rel="prefetch" href="/mydairy/assets/js/28.3c1efd17.js"><link rel="prefetch" href="/mydairy/assets/js/29.7e2303b5.js"><link rel="prefetch" href="/mydairy/assets/js/3.ffe8549c.js"><link rel="prefetch" href="/mydairy/assets/js/30.7dbb671e.js"><link rel="prefetch" href="/mydairy/assets/js/31.35ecee6e.js"><link rel="prefetch" href="/mydairy/assets/js/32.ea2ce080.js"><link rel="prefetch" href="/mydairy/assets/js/33.2c92d913.js"><link rel="prefetch" href="/mydairy/assets/js/34.a62cfaba.js"><link rel="prefetch" href="/mydairy/assets/js/35.bc3513d7.js"><link rel="prefetch" href="/mydairy/assets/js/36.8b60e39c.js"><link rel="prefetch" href="/mydairy/assets/js/37.942ffb8a.js"><link rel="prefetch" href="/mydairy/assets/js/38.bca56a1e.js"><link rel="prefetch" href="/mydairy/assets/js/39.d79fb24d.js"><link rel="prefetch" href="/mydairy/assets/js/4.9b0846a4.js"><link rel="prefetch" href="/mydairy/assets/js/40.00707b20.js"><link rel="prefetch" href="/mydairy/assets/js/5.fa7dc1d3.js"><link rel="prefetch" href="/mydairy/assets/js/6.1e3b789f.js"><link rel="prefetch" href="/mydairy/assets/js/7.b078faa6.js"><link rel="prefetch" href="/mydairy/assets/js/8.9448d2f8.js"><link rel="prefetch" href="/mydairy/assets/js/9.17d944a4.js">
    <link rel="stylesheet" href="/mydairy/assets/css/0.styles.1cf60974.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mydairy/" class="home-link router-link-active"><!----> <span class="site-name">zanzan学习日记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/zxy7/mydairy" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/zxy7/mydairy" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>javascript</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/mydairy/javascript/js基础.html" class="active sidebar-link">js基础</a></li><li><a href="/mydairy/javascript/vue的浏览器兼容问题.html" class="sidebar-link">vue的浏览器兼容问题</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>翻译</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>记录</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>微信小程序</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>python</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>java</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="js基础"><a href="#js基础" aria-hidden="true" class="header-anchor">#</a> js基础</h1> <ol><li><ul><li><code>typeof</code> 判断数据类型<code>undefined</code>,<code>number</code>,<code>string</code>,<code>symbol</code>,<code>boolean</code>,<code>object</code>,<code>function</code>,(不能判断<code>null</code>,<code>array</code>)</li> <li><code>instanceof</code> 检测原型（<code>a.__proto__==b.prototype</code>)</li> <li><code>f.constructor == F</code></li> <li><code>Object.prototype.toString.call('')=&quot;[object String]&quot;</code></li></ul></li> <li><code>_proto_</code>指向创建该对象的构造函数的原型（<code>F.prototype</code>），通过<code>_proto_</code>组成的原型链寻找不属于该对象的属性
<code>prototype</code>是每个函数都有的属性</li> <li><code>this</code> 指调用函数的对象，构造函数<code>this</code>绑定里他创建的对象，不会改变，<code>call</code>，<code>apply</code>,<code>bind</code>可以改变<code>this</code>指向，箭头函数没有<code>this</code>，他的<code>this</code>取决于外面的函数</li> <li><code>Child</code>继承<code>Parent</code> <ul><li>构造函数在<code>Child</code>里面<code>Parent.call(this)</code>,相当于拷贝<code>Parent</code>，浪费内存，不会继承<code>Parent.prototype</code></li> <li>原型继承<code>Child.prototype=new Parent()</code> ，引用属性会被共享</li> <li>组合
<ul><li>属性用在<code>Child</code>里面<code>Parent.call(this)</code>，</li> <li>方法用<code>Child.prototype =Object.create(Parent.prototype)</code>;继承<code>Parent</code>方法，（类似写法<code>Child.prototype = new Parent（)</code>和 <code>Child.prototype = Parent.prototype）</code></li> <li><code>Child.prototype.constructor = Child</code>;修复<code>Child</code>的<code>constructor</code> 指向</li></ul></li> <li><div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span><span class="token punctuation">{</span>

 <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><code>let</code> 不能在声明前使用</li> <li>非匿名的立即执行函数会把函数名当作该函数的内部只读属性</li> <li>闭包是函数A return函数B，函数B使用里A的变量，缓存了这个变量</li> <li>for循环中的定时可以用let定义i，或者用闭包（function（i）{})(i),或者setTimeout的第三个参数i</li> <li>基本类型保存在栈，引用类型保存在堆（通过栈中的内存地址找到堆中的值）</li> <li><ul><li>浅拷贝:Object.assign({},a)    {...a}值解决第一层的拷贝</li> <li>深拷贝：
<ul><li>JSON.parse(JSON.stringify(object))忽略了undefined，函数，循环引用的对象</li> <li>jquery.extend(true,target,object)递归思路</li> <li>new Function（&quot;return &quot;+obj.toString()）拷贝函数，数组中是对象就递归，递归浅拷贝</li></ul></li></ul></li> <li><ul><li>es6模块化export/import，babel编译成require/exports，异步导入，值引用，实时绑定，导入导出的值都指向同一个内存地址，改变了会有影响，</li> <li>conmmonjs是node中的规范，module.exports暴露， require引入，Browserify 解析，支持动态导入，同步导入，值拷贝，改变了不会影响导入值</li></ul></li> <li>
<ul><li>防抖,防二次点击,边输入边搜索
<ul><li>button的disabled属性</li> <li><div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">debounce</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span>wait<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token operator">=</span><span class="token number">0</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
      timer<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          func<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>wait<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li>节流 每隔一段时间执行</li> <li><div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">throttle</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span>wait<span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">var</span> timer<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
     <span class="token keyword">var</span> previous<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">var</span> now<span class="token operator">=</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>previous<span class="token punctuation">)</span> previous<span class="token operator">=</span>now<span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>now<span class="token operator">-</span>previous<span class="token operator">&gt;</span>time<span class="token punctuation">)</span><span class="token punctuation">{</span>
             <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
             <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
             previous<span class="token operator">=</span>now
         <span class="token punctuation">}</span>
         <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
         timer<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
             <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>wait<span class="token punctuation">)</span>

     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li>setTimeout
<ul><li>倒计时</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">dida</span><span class="token punctuation">(</span>wait<span class="token punctuation">)</span><span class="token punctuation">{</span>
    wait<span class="token operator">--</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>wait<span class="token punctuation">)</span>
    t<span class="token operator">=</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">dida</span><span class="token punctuation">(</span>wait<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>wait<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><ul><li>模拟实现call</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mycall</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> contenxt<span class="token operator">=</span>context<span class="token operator">||</span>window
    context<span class="token punctuation">.</span>fn<span class="token operator">=</span><span class="token keyword">this</span>
    <span class="token keyword">var</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
    <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
<span class="token punctuation">}</span>
</code></pre></div><ul><li>模拟实现apply</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myapply</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> contenxt<span class="token operator">=</span>context<span class="token operator">||</span>window
    context<span class="token punctuation">.</span>fn<span class="token operator">=</span><span class="token keyword">this</span>
    context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
<span class="token punctuation">}</span>
</code></pre></div><ul><li>模拟bind</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mybind</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> me<span class="token operator">=</span><span class="token keyword">this</span>
    <span class="token keyword">var</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">me</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">,</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> me<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>promise，then/catch/try，all，race，resolve，reject</li> <li>0.1 + 0.2 != 0.3原因： JS 采用 IEEE 754 双精度版本（64位），0.1的二进制是个二进制无限循环小数，parseFloat((0.1+0.2).toFixed(10))</li> <li>数组去重
<ul><li>es6新数据结构Set，值唯一，set.add（item），[...new Set（arr）]/Array.from(new Set(arr))去重的数组</li> <li>forEach（）/for循环，indexof判断索引</li> <li>对象属性值唯一</li></ul></li> <li>垃圾回收GC算法，将内存（堆）
<ul><li>新生代：存活时间端的对象，新分配的对象存from，满了后，将存活的对象复制到to，from清空，互换</li> <li>老生代：存活时间长，数量多的对象，标记清除算法和标记压缩算法，to空间超过25%就移到老生代空间</li></ul></li></ol> <hr> <ol><li>事件触发：w3c先捕获，到了目标元素再冒泡，冒泡（默认false），ie只支持冒泡，另外给一个元素同时都加了冒泡和捕获，先冒泡在捕获
<ul><li>window.event.cancelBubble = true关闭捕获冒泡</li> <li>event.stopPropagation（）阻止事件冒泡</li> <li>event.preventDefat（）阻止默认行为（超链接跳转）</li></ul></li> <li>事件代理/委托：把注册事件加在父节点上，节省内存</li> <li>跨域：
<ul><li>jsonp动态添加script，用get请求，jquery dataType：jsonp</li> <li>cors跨域资源共享 服务器端设置access-control-allow-origin</li> <li>nginx代理跨域</li> <li>document.domain二级域名相同时可用</li> <li>postmessage（data，origin），h5 api</li> <li>websoket ，h5</li> <li>开发环境设置浏览器： disable-web-security 关闭安全策略</li> <li>vue nodejs中间件设置代理服务器proxy changeorigin：true</li></ul></li> <li>事件循环：js在执行过程中产生执行环境，执行环境按顺序加入执行栈，异步的代码会被挂起加入到task队列，执行栈为空会从task任务队列中拿出需要执行的代码放到队列中
<ul><li>settimeout有4ms的延时</li> <li>主线程=&gt;process.nexttick=&gt;promise=&gt;Object.observe(微任务)=&gt;settimeout（宏任务）</li></ul></li> <li>cookie属性value，http-only（不能通过js获取，减少xss），secure（https才能携带），same-site（跨域不能带，减少csrf）</li> <li>serviceWorker缓存文件</li> <li>浏览器渲染：
<ul><li>处理html构建dom树</li> <li>cssom树</li> <li>合并成一个渲染树</li> <li>布局计算节点位置</li> <li>绘制</li></ul></li> <li>load事件是等dom，css，js，图片加载完毕，domcontentloaded是html被加载解析</li> <li>重绘改变外观不影响布局，回流是布局改变</li> <li>jquery对象转dom对象 $(&quot;#a&quot;).get(0),反之，$(dom对象)</li></ol> <hr> <ol><li>性能
<ul><li>dns预解析<link rel="dns-prefetch" href="//com"></li> <li>缓存
<ul><li>强制缓存cache-control，expires，返回200</li> <li>协商缓存last-modified/if-modified-since，etag/if-none-match，返回304</li></ul></li> <li>http2.0多路复用，header压缩</li> <li>预加载 link rel=&quot;preload&quot;</li> <li>预渲染 link rel=&quot;prerender&quot;</li> <li>懒执行，懒加载（图片）</li> <li>图片优化
<ul><li>压缩图片</li> <li>雪碧图</li> <li>小图用base64</li> <li>懒加载
<ul><li>src里用一个占位图</li> <li>window.onscroll+节流/防抖函数</li> <li>根据document.body.scrolltop||document.documentElement.scrolltop</li> <li>给所有的图片加class，函数里面for循环遍历img，判断图片的offsettop是否小于scrolltop，小于则替换src，该class删除</li></ul></li></ul></li> <li>css放head</li> <li>script放body底</li> <li>cdn加载静态资源</li> <li>webpack打包压缩，按路由拆分代码，按需加载const F=（）=&gt;import(&quot;&quot;)</li> <li>window.onerror报错</li></ul></li> <li>xss,跨站脚本攻击，评论里一个带恶意script，转义，内容安全策略 (CSP），设置 Header 中的 Content-Security-Policy</li> <li>csrf，验证referer</li></ol> <hr> <ol><li>mvvm：model和view独立，由viewmodel作为桥梁只关心数据和业务的处理，不关心view如何处理数据
<ul><li>vue数据劫持：vue遍历data中所有的属性，Object.defineProperty(obj,key,{})实现数据绑定，监听数据的set和get事件，给添加发布订阅，get中添加订阅，set中发布，手动触发一次属性的 getter 来实现发布订阅的添加</li></ul></li> <li>路由：监听url的变化，匹配路由规则，显示页面，无须刷新，由hash模式和history模式</li> <li>virtual dom：操作dom费时，用js对象模拟dom对象，操作js对象比操作dom省时， diff算法之比对同层节点，O(n)复杂度，局部更新dom
<ul><li>tags字符串，document.createElement(tag)</li> <li>props对象，el.setAttribute(key, props[key])</li> <li>children数组，</li> <li>key唯一表示标识，el.setAttribute('key', key)</li></ul></li></ol> <hr> <ol><li><p>nextTick是在下次 DOM 更新循环结束之后执行延迟回调</p></li> <li><p>vue生命周期：new vue实例，beforecreate：data，props还没有</p></li> <li><p>组件</p> <ul><li>组件的data必须是函数，每个实例都可以维护return的对象的独立的拷贝，不会影响其他实例</li> <li>组件注册：Vue.component全局注册(在根 Vue 实例创建之前发生)，局部注册components：{ComponentA}</li> <li>每个组件只有一个根元素</li> <li>emit方法传入事件名，向父组件触发监听的事件，以修改子组件的prop</li> <li>v-model是v-bind：value=“x”  v-on：input=“x=$event.target.value”，默认名为value 的prop和input事件</li> <li>原生事件v-on：事件名.native修饰符</li> <li>动态组件加keep-live缓存</li></ul></li> <li><p>计算属性computed:{xx:{get:function(){},set:function(){}}，基于它们的依赖进行缓存的，
侦听属性watch:{xx:function(){}}</p></li> <li><p>冒泡排序</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">maopao</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> item<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> j<span class="token operator">=</span>i<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&gt;</span>arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                item<span class="token operator">=</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
                arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>
                arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>item
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>全排列</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">swap</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> t<span class="token punctuation">;</span>
    t <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> 
    array<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">permutation</span><span class="token punctuation">(</span>ls<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ls<span class="token punctuation">.</span>length <span class="token operator">?</span> ls<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">permutation</span><span class="token punctuation">(</span>ls<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>e <span class="token operator">=&gt;</span> e <span class="token operator">!=</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">permutation</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>json转树形结构</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> nodes <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;cname&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;第一级1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;cname&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;第一级1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&quot;cname&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;第一级1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&quot;cname&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;第一级1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">&quot;cname&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;第一级1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">&quot;cname&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;第一级1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>		
<span class="token keyword">function</span> <span class="token function">transDate</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span>idstr<span class="token punctuation">,</span>pidstr<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>temp <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        temp<span class="token punctuation">[</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>idstr<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//将nodes数组转成对象类型</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        tempVp <span class="token operator">=</span> temp<span class="token punctuation">[</span>list<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>pidstr<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//获取每一个子对象的父对象</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tempVp<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//判断父对象是否存在，如果不存在直接将对象放到第一层</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>tempVp<span class="token punctuation">[</span><span class="token string">&quot;nodes&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> tempVp<span class="token punctuation">[</span><span class="token string">&quot;nodes&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//如果父元素的nodes对象不存在，则创建数组</span>
            tempVp<span class="token punctuation">[</span><span class="token string">&quot;nodes&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将本对象压入父对象的nodes数组</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将不存在父对象的对象直接放入一级目录</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">transDate</span><span class="token punctuation">(</span>nodes<span class="token punctuation">,</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ipid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div></li> <li><p>ajax，axios，fetch</p> <ul><li>ajax异步 async：true默认，对原生XHR的封装，还增添了对JSONP的支持<div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
    url<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>responseText<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token operator">&gt;=</span><span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            success <span class="token operator">&amp;&amp;</span> success<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            error <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>promise实现Axios本质上也是对原生XHR的封装，提供了一些并发请求的接口，客户端支持防止CSRF<div class="language-js extra-class"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>method<span class="token punctuation">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'/x'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>SuccessFn1<span class="token punctuation">,</span> commonErrorFn<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">{</span> 
        <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
        xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token operator">&gt;=</span><span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span> 
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>xhr<span class="token punctuation">)</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li>fetch</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Oops, error&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>hash和history</p> <ul><li>hash原理window.onhashchange事件</li> <li>history原理history api （pushState、replaceState、go、back、forward),在window对象上监听popState()事件<div class="language-js extra-class"><pre class="language-js"><code>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//后退两次</span>
history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//前进两次</span>
history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//后退</span>
hsitory<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//前进</span>
</code></pre></div></li></ul></li> <li><p>computed和watch</p> <ul><li>computed根据一个变量计算得到另一个属性，计算属性具有缓存，多次访问不必重新执行那个函数，一个数据依赖于其他数据时使用</li> <li>watch是监听一个值的变化，执行对应函数，在数据变化是做些事情</li></ul></li> <li><p>异步编程</p> <ul><li>回调函数(f2写成f1的回调函数)不利于阅读维护，每个任务只能制定一个回调函数<div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//f1的代码</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div></li> <li>事件监听
事件驱动模式，取决于某个事件是否发生<div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token comment">//f1的代码</span>
         f1<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 f1<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">,</span>f2<span class="token punctuation">)</span>
</code></pre></div></li> <li>发布/订阅<div class="language-js extra-class"><pre class="language-js"><code>jQuery<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&quot;done&quot;</span><span class="token punctuation">,</span>f2<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//f1的代码</span>
        jQuery<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
jQuery<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token string">&quot;done&quot;</span><span class="token punctuation">,</span> f2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>promise对象,为异步编程提供统一接口,回调函数变成链式写法，流程很清楚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token comment">//then（成功回调函数，失败毁掉函数）</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>f3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//链式写法是在回调函数执行完后return返回结果作为下一个then的回调函数的参数</span>
    <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span>f3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/zxy7/mydairy/edit/master/docs/javascript/js基础.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/mydairy/assets/js/app.75fc6940.js" defer></script><script src="/mydairy/assets/js/13.14b33cee.js" defer></script>
  </body>
</html>
